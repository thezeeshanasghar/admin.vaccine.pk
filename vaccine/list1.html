<script type="text/javascript">
    if (sessionStorage.getItem('login') !== 'true') {
        // If the user is not logged in, redirect them to the login page
        window.location.href = 'login.html';
    }
</script>
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Vaccine</title>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <link href="/assets/img/favicon.png" rel="icon" />
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet" />

    <!-- Vendor CSS Files -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link href="/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
    <link href="/assets/vendor/quill/quill.snow.css" rel="stylesheet" />
    <link href="/assets/vendor/quill/quill.bubble.css" rel="stylesheet" />
    <link href="/assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
    <link href="/assets/vendor/simple-datatables/style.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="/assets/css/style.css" rel="stylesheet" />

    <!-- =======================================================
      * Template Name: NiceAdmin - v2.4.1
      * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
      * Author: BootstrapMade.com
      * License: https://bootstrapmade.com/license/
      ======================================================== -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">
        <iframe src="/header.html"
            onload="this.insertAdjacentHTML('afterend', (this.contentDocument.body||this.contentDocument).innerHTML);this.remove()"></iframe>
    </header>
    <!--End Header -->

    <iframe src="/sidebar.html"
        onload="this.insertAdjacentHTML('afterend', (this.contentDocument.body||this.contentDocument).innerHTML);this.remove()"></iframe>

    <main id="main" class="main">
        <div class="pagetitle">
            <h1>Vaccines</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
                    <li class="breadcrumb-item active">Vaccines</li>
                </ol>
            </nav>
        </div><!-- End Page Title -->
        <section class="section dashboard">
            <div class="row">
                <!-- Left side columns -->
                <div class="col-lg-12">
                    <div class="card recent-sales overflow-auto">
                        <div class="card-body">
                            <div class="filter">
                                <a class="icon" href="#" data-bs-toggle="dropdown" style="float: right"><i
                                        class="fa fa-plus"></i></a>
                                <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                                    <li>
                                        <a class="dropdown-item" href="/vaccine/add.html">Add Vaccine</a>
                                    </li>
                                </ul>
                            </div>
                            <h5 class="card-title">Vaccines Table</h5>
                            <!-- <div id="successMessage" style="display:none;margin-top: 10px;"
                                                    class="alert alert-success alert-dismissible fade show" role="alert">
                                                    <i class="bi bi-check-circle me-1"></i><span id="zxcv"></span>
                                                    <button type="button" class="btn-close" data-bs-dismiss="alert"
                                                        aria-label="Close"></button>
                                                </div>
                                                <div id="errorMessage" style="display:none;margin-top: 10px;"
                                                    class="alert alert-danger alert-dismissible fade show" role="alert">
                                                    <i class="bi bi-exclamation-octagon me-1"></i><span id="asdf"></span>
                                                    <button type="button" class="btn-close" data-bs-dismiss="alert"
                                                        aria-label="Close"></button> -->
                        </div>
                        <!-- <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th scope="col">Vaccines Table</th>
                                </tr>
                            </thead> -->
                        <!-- <tbody id="myvaccinedata"></tbody>
                        </table> -->
                        <div class="row" id="myvaccinedata">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="basicModa2" tabindex="-1" aria-hidden="true" style="display: none;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <!-- <div class="modal-header">
                                    <h5 class="modal-title">
                                        Delete Vaccine
                                    </h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                    </button>
                                </div> -->
                        <div id="successMessage1" style="display:none;margin-top: 10px;"
                            class="alert alert-success alert-dismissible fade show" role="alert">
                            <i class="bi bi-check-circle me-1"></i><span id="zxcv1"></span>
                            <!-- <button type="button" class="btn-close" data-bs-dismiss="alert"
                                    aria-label="Close"></button> -->
                        </div>
                        <div id="errorMessage1" style="display:none;margin-top: 10px;"
                            class="alert alert-danger alert-dismissible fade show" role="alert">
                            <i class="bi bi-exclamation-octagon me-1"></i><span id="asdf1"></span>
                            <!-- <button type="button" class="btn-close" data-bs-dismiss="alert"
                                    aria-label="Close"></button> -->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                Ok
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="basicModal" tabindex="-1" aria-hidden="true" style="display: none;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                Delete Vaccine
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            if you are sure to delete vaccine then press ok either press cancel
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                Cancel
                            </button>
                            <button id="ok" class="btn btn-primary">
                                Ok
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="basicModal1" tabindex="-1" aria-hidden="true" style="display: none;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                You not add dose
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            The dose you want to add is infinite so it is not added
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                Ok
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main><!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
        <div class="copyright">
            &copy; Copyright <strong><span>NiceAdmin</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
            <!-- All the links in the footer should remain intact. -->
            <!-- You can delete the links only if you purchased the pro version. -->
            <!-- Licensing information: https://bootstrapmade.com/license/ -->
            <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/ -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
        </div>
    </footer><!-- End Footer -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"></script>
    <script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/vendor/chart.js/chart.min.js"></script>
    <script src="/assets/vendor/echarts/echarts.min.js"></script>
    <script src="/assets/vendor/quill/quill.min.js"></script>
    <!-- <script src="/assets/vendor/simple-datatables/simple-datatables.js"></script> -->
    <!-- <script src="/assets/vendor/datatables/datatables.min.js"></script> -->
    <script src="/assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="/assets/vendor/php-email-form/validate.js"></script>
    <!-- Template/e -->
    <script src="/assets/js/main.js"></script>
    <!-- <script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/simplebar/simplebar.min.js"></script>
<script src="assets/libs/feather-icons/feather.min.js"></script>
<script src="assets/js/ap.js"></script> -->
    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>
    <script type="text/javascript">
        $(function () {
            $.get(`https://myapi.fernflowers.com/api/Vaccine/vaccine-with-count`, function (data, status) {
                console.log(data);
                $.each(data, function (val, text) {
                    console.log(text);
                    $("#myvaccinedata").append(`
                    <div id="msgbox" class="card recent-sales overflow-auto">
                            <div class="card-body">
                            <content>
                                <div class="welcome-card">
                                    <div class="row" style="width: auto; height: auto;padding-top: 10px;">
                                        <div class="col-12">
                                            <table style="width: auto; height: auto;table-layout:fixed;">
                                                    <tr>
                                            <td scope="col"><i class="fa-solid fa-syringe" style="font-size: 50px; color: blue;"></i></td>
                                                <td  style="width: 590px; height: auto;"><span style="padding-left: 15px; font-weight: ;font-size: 40px;">${text.vaccine.Name}</span></td>
                                            <td style="width: 150px; height: auto;" scope="col"><span style="padding-left: 10px; font-weight: bold;font-size: 20px;">IsSpecial:</span><span style="padding-left: 1px; font-size: 20px;">${text.vaccine.IsSpecial}</span></td>
                                            <td style="width: 150px; height: auto;" scope="col"><span style="padding-left: 1px; font-weight: bold;font-size: 20px;">Infinite:</span><span style="padding-left: 1px; font-size: 20px;">${text.vaccine.Infinite}</span></td>
                                        <td style="color:white"></td>
                                       
                                            <td scope="col"><i class="fas fa-edit pe-3" class="col-12 d-flex justify-content-end flex-row" data-id="${text.vaccine.Id}" data-id1="${text.vaccine.Name}" data-id2="${text.vaccine.IsSpecial}" data-id3="${text.vaccine.Infinite}" data-id4="${text.DoseCount}" id="addu" style="font-size: 50px; color: blue;cursor:pointer;margin-left:100px"></i></td>
                                            <td><i class="fa-solid fa-trash-can" data-id="${text.vaccine.Id}" style="font-size: 50px; color: blue;cursor:pointer"></i></td>
                                       
                                            </tr>
                                                </table>
                                                    <hr>
                                                <table style="width: auto; height: auto;table-layout:fixed;">
                                                    <tr>
                                                 <td></td>       
                                <td><button style="white-space: nowrap;margin-left:5px" type="button" onclick="myFunction(${text.vaccine.Infinite},${text.DoseCount},${text.vaccine.Id})" id="addd" data-id="${text.vaccine.Id}" class="btn btn-outline-primary btn-lg"><span class="pe-31">ADD DOSE</span></button></td>
                                    <td><a style="white-space: nowrap;margin-left:5px" type="button" href="/brand/add.html?action=add&id=${text.vaccine.Id}" id="addb" class="btn btn-outline-primary btn-lg"><span class="pe-3">ADD BRAND</span></a></td>
                                        <td> </td>
                                            <td><a style="white-space: nowrap;margin-left:540px" type="button" type="button" href="/vaccine/dlist.html?action=get&id=${text.vaccine.Id}" class="btn btn-outline-primary btn-lg"><span class="pe-3">DOSES</span><span style="padding: 0 10px;background: blue; color: white;">${text.DoseCount}</span></a></td>
                                                <td><a style="white-space: nowrap;margin-left:5px;margin-right:5px" type="button" href="/vaccine/blist.html?action=get&id=${text.vaccine.Id}" class="btn btn-outline-primary btn-lg"><span class="pe-3">BRANDS</span><span style="padding: 0 10px;background: blue; color: white;">${text.BrandCount}</span></a></td>
                                                    </tr>
                                                </table>
                                    </div>
                                </div>
                            </content>
                        </div >
                    </div >`
                    );
                });
            });
        });
        $(document).on("click", ".pe-3", function () {
            var ids = $(this).data("id");
            var ids1 = $(this).data("id1");
            var ids2 = $(this).data("id2");
            var ids3 = $(this).data("id3");
            var ids4 = $(this).data("id4");
            console.log(ids, ids1, ids2, ids3);
            window.location.assign(`./update.html?action=patch&id=${ids}&id1=${ids1}&id2=${ids2}&id3=${ids3}&id4=${ids4}`);
        });

        function myFunction(a, b, c) {
            var bt = document.getElementById('addd');
            if (a == true && b >= 1) {
                console.log("atta");
                $('#basicModal1').modal('show');
                document.getElementById("addd").disabled = true;
            }
            else {
                console.log(c);
                window.location.assign(`../dose/add.html?action=add&id=${c}`);
            }
        }
        $(document).on("click", ".fa-trash-can", function () {
            console.log('success');
            $('#basicModal').modal('show');
            var ids = $(this).data("id");
            console.log(ids);
            var ele = this;
            //let text = "if you are sure to delete then press ok either press cancel";
            //       if (confirm(text) == true) {
            $(document).on("click", ".btn-primary", function () {
                $('#basicModal').modal("hide");
                $.ajax({
                    type: "delete",
                    data: ids,
                    url: `https://myapi.fernflowers.com/api/Vaccine/${ids}`,

                    success: function (data) {

                        // console.log(data)
                        $('#basicModa2').modal('show');
                        $("#errorMessage1").hide('fast');
                        $("#successMessage1").show();
                        $("#zxcv1").html("Your selected vaccine delete successfully")
                        $(ele).closest("#msgbox").fadeOut();
                        // $("#msgbox").fadeOut()
//                         $("#msgbox").fadeOut(100, function(){ 
//     $(this).remove();
// });
                    },
                    error: function (data) {
                        console.log(data)
                        $('#basicModa2').modal('show');
                        $("#successMessage1").hide('fast');
                        $("#errorMessage1").show();
                        $("#asdf1").html(data.responseText)
                    },
                })
            })
            // } else {
            //         $("#error-Message").html("Can't Delete Record.").slideDown();
            //          $("#success-Message").slideUp();

            //      }

        });
    </script>
</body>

</html>